{{ with .Resources.GetMatch (printf "*%s" .Params.heroImage) }}
  {{ $img := . }}
  {{ $small := $img.Resize "640x" }}
  {{ $medium := $img.Resize "960x" }}
  {{ $large := $img.Resize "1280x" }}
  {{ $hd := $img.Resize "1920x" }}
  {{ $2k := $img.Resize "2560x" }}
  {{ $4k := $img.Resize "3840x" }}

  <div class="position-relative w-100" style="height:60vh; max-height:40vh;">
    <picture>
      <source
        media="(min-width:1200px)"
        srcset="{{ $4k.RelPermalink }} 3840w, {{ $2k.RelPermalink }} 2560w"
      >
      <source
        media="(min-width:992px)"
        srcset="{{ $hd.RelPermalink }} 1920w, {{ $large.RelPermalink }} 1280w"
      >
      <source
        media="(min-width:768px)"
        srcset="{{ $medium.RelPermalink }} 960w, {{ $small.RelPermalink }} 640w"
      >
      <img
        src="{{ $small.RelPermalink }}"
        srcset="
          {{ $small.RelPermalink }} 640w,
          {{ $medium.RelPermalink }} 960w,
          {{ $large.RelPermalink }} 1280w,
          {{ $hd.RelPermalink }} 1920w,
          {{ $2k.RelPermalink }} 2560w,
          {{ $4k.RelPermalink }} 3840w
        "
        sizes="100vw"
        class="position-absolute top-0 start-0 w-100 h-100 object-fit-cover"
        alt="{{ default $.Title $.Params.heroTitle }}"
      >
    </picture>

    <div class="position-absolute top-0 start-0 w-100 h-100 d-flex flex-column justify-content-center align-items-center bg-dark bg-opacity-50 text-center text-white">
      <div class="container px-3 px-md-0">
        <h1 class="display-4 fw-bold">{{ default $.Title $.Params.heroTitle }}</h1>
        {{ with $.Params.heroDescription }}
          <p class="lead fs-3">{{ . | markdownify }}</p>
        {{ end }}
        {{ with $.Param "heroButton" }}
        <p>
            <a href="{{ $.Param "heroButton.link" }}" class="btn btn-success my-2" title="{{ $.Param "heroButton.label" }}">{{ $.Param "heroButton.label" }}</a>
        </p>
        {{ end }}
        {{ if and (eq $.Section "blog") (eq $.Kind "page") }}
        <div class="mt-3 small">
          <time datetime="{{ $.PublishDate.Format "2006-01-02" }}">
            {{ $.PublishDate | time.Format ":date_full" }}
          </time>
          {{ if not ($.Lastmod.Equal $.PublishDate) }} • {{ i18n "updated" }} {{ $.Lastmod | time.Format ":date_full" }}{{ end }}
          • {{ i18n "readingTime" }} <strong>{{ $.ReadingTime }} {{ i18n "minutes" }}</strong>
        </div>
        {{ end }}
      </div>
    </div>

    {{ with $.Params.heroImageCredit }}
      <div class="position-absolute bottom-0 end-0 p-1 m-1 text-end text-white bg-dark bg-opacity-50 rounded small">
        {{ i18n "image" }}:
        {{ if and $.Params.heroImageLicense $.Params.heroImageLicenseURL }}
          <a
            href="{{ $.Params.heroImageLicenseURL }}"
            target="_blank"
            rel="noopener noreferrer"
            class="text-white text-decoration-underline"
            title="{{ $.Params.heroImageLicense }}"
          >
            {{ $.Params.heroImageCredit }}
          </a>
        {{ else }}
          {{ . }}
        {{ end }}
      </div>
    {{ end }}
  </div>
{{ else }}
{{/* Color-keyed gradient dict (for WG pages with explicit `color:` param) */}}
{{- $gradients := dict
  "blue"   "135deg, #08152e 0%, #0d2452 55%, #081a38 100%"
  "green"  "135deg, #0a1f14 0%, #0d3d24 55%, #0a2f14 100%"
  "orange" "135deg, #1e0c05 0%, #3d1a08 55%, #2a140a 100%"
  "purple" "135deg, #110820 0%, #2a0d3d 55%, #0e0820 100%"
  "teal"   "135deg, #051d1d 0%, #0b3838 55%, #051d24 100%"
  "red"    "135deg, #200808 0%, #3d0d0d 55%, #200a14 100%"
-}}
{{/* Section-based gradient fallback so every section type has a distinct palette */}}
{{- $sectionGrads := dict
  "blog"      "135deg, #0c0e2a 0%, #142058 50%, #0a183a 100%"
  "members"   "135deg, #10082a 0%, #200d42 50%, #0c0820 100%"
  "about"     "135deg, #0a0c20 0%, #141c3a 50%, #0a1428 100%"
  "events"    "135deg, #1a0a04 0%, #38200a 50%, #1a1408 100%"
  "resources" "135deg, #041a18 0%, #083430 50%, #041a24 100%"
  "pqcc"      "135deg, #0c1428 0%, #142050 50%, #0c1a2e 100%"
  "activities" "135deg, #041816 0%, #083028 50%, #041820 100%"
-}}
{{- $sectionGrad := index $sectionGrads ($.Section | default "") | default "" -}}
{{- $grad := index $gradients ($.Params.color | default "") | default $sectionGrad | default "135deg, #0a1f14 0%, #0d3d24 55%, #0a2f40 100%" -}}
<div class="pkic-page-hero" style="background: linear-gradient({{ $grad }});">
  <div class="container py-5">
    <div class="row justify-content-center text-center">
      <div class="col-lg-8">
        {{ with $.Params.wgID }}
        <p class="pkic-page-hero-kicker">Working Group &mdash; {{ . }}</p>
        {{ else }}{{ with $.Params.heroKicker }}
        <p class="pkic-page-hero-kicker">{{ . }}</p>
        {{ end }}{{ end }}
        <h1 class="display-5 fw-bold text-white mb-3">{{ default $.Title $.Params.heroTitle }}</h1>
        {{ with $.Params.heroDescription }}
          <p class="lead text-white opacity-75 mb-4">{{ . | markdownify }}</p>
        {{ end }}
        {{ with $.Param "heroButton" }}
        <p class="mb-0">
          <a href="{{ $.Param "heroButton.link" }}"
             class="btn btn-light btn-lg px-4 fw-semibold me-2"
             title="{{ $.Param "heroButton.label" }}">{{ $.Param "heroButton.label" }}</a>
        </p>
        {{ end }}
        {{ if and (eq $.Section "blog") (eq $.Kind "page") }}
        <div class="mt-3 small text-white opacity-75">
          <time datetime="{{ $.PublishDate.Format "2006-01-02" }}">{{ $.PublishDate | time.Format ":date_full" }}</time>
          {{ if not ($.Lastmod.Equal $.PublishDate) }} &bull; {{ i18n "updated" }} {{ $.Lastmod | time.Format ":date_full" }}{{ end }}
          &bull; {{ i18n "readingTime" }} <strong>{{ $.ReadingTime }} {{ i18n "minutes" }}</strong>
        </div>
        {{ end }}
      </div>
    </div>
  </div>
</div>
{{ end }}